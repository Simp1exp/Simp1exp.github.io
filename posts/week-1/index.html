<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="XSS #  What’s this? #   Cross Site Scripting or XSS is a type of injection attack. All injection attacks consist in using the input field that the application provides to entry arbitrary data. In XSS case, the arbitrary data is normally written in JavaScript, but may also include HTML, Flash, or any other type of code that the browser may execute. There are three types of XSS: Reflected, Stored and DOM-Based.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Week 1" />
<meta property="og:description" content="XSS #  What’s this? #   Cross Site Scripting or XSS is a type of injection attack. All injection attacks consist in using the input field that the application provides to entry arbitrary data. In XSS case, the arbitrary data is normally written in JavaScript, but may also include HTML, Flash, or any other type of code that the browser may execute. There are three types of XSS: Reflected, Stored and DOM-Based." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://simp1exp.github.io/posts/week-1/" /><meta property="article:section" content="posts" />



<title>Week 1 | My New Hugo Site</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css" integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.dccf3676d1d811028adb8bbc3e1849b924a19bf7ca3d5014302ca903b459f544.js" integrity="sha256-3M82dtHYEQKK24u8PhhJuSShm/fKPVAUMCypA7RZ9UQ=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/logo.jpg" alt="Logo" /><span>My New Hugo Site</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/introduction/" class="">Introduction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/week-1/" class=" active">Week 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/week-2/" class="">Week 2</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Week 1</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#whats-this"><strong>What’s this?</strong></a>
      <ul>
        <li><a href="#reflected-xss">Reflected XSS</a></li>
        <li><a href="#stored-xss">Stored XSS</a></li>
      </ul>
    </li>
    <li><a href="#who-to-fix-it"><strong>Who to fix it?</strong></a>
      <ul>
        <li><a href="#reflected-fix">Reflected fix:</a></li>
        <li><a href="#stored-fix">Stored fix:</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown">
  <h1>
    <a href="/posts/week-1/">Week 1</a>
  </h1>
  


  

  



<h1 id="xss">
  <strong>XSS</strong>
  <a class="anchor" href="#xss">#</a>
</h1>
<h2 id="whats-this">
  <strong>What’s this?</strong>
  <a class="anchor" href="#whats-this">#</a>
</h2>
<ul>
<li><strong>Cross Site Scripting or XSS</strong> is a type of injection attack. All injection attacks consist in using the input field that the application provides to entry arbitrary data. In XSS case, the arbitrary data is normally written in JavaScript, but may also include HTML, Flash, or any other type of code that the browser may execute. There are three types of XSS: Reflected, Stored and DOM-Based. In this course we only learn about the first and the second one, for these, the events happen in this order:
<ol>
<li>The arbitrary data is sent to the server</li>
<li>The server processes the data and return it back to the user</li>
<li>When this web page code arrives, the browser reads it and triggers the non-sanitized code embedded in the web page.</li>
</ol>
</li>
</ul>
<p>The only difference between Reflected and Stored XSS is the second step. As the name suggests, in the first one the code returns to the user but it’s not stored in the server and it only happens when the user sends the request to the server. The second is much more dangerous because it happens with every one who enters the web page.</p>
<h3 id="reflected-xss">
  Reflected XSS
  <a class="anchor" href="#reflected-xss">#</a>
</h3>
<p>Example:</p>
<p>
  <img src="../../image.PNG" alt="Example image" />
This is an application in WebGoat that demonstrate how Reflected XSS works. See the value “I’m here” in the input field being reflected in the web page? This indicates our application may be vulnerable.

  <img src="../../5.PNG" alt="Example image" />
To test the application, we need to input a payload, in this case I’m using <code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>.

  <img src="../../17.PNG" alt="Example image" />
Now we are certain the application is vulnerable. Ok, this is cool and all but we can’t do much with it. Generally reflected XSS can do bad things when the data reflected can be embedded in the URL.</p>
<p>Example:</p>
<p>
  <img src="../../1.PNG" alt="Example image" />

  <img src="../../2.PNG" alt="Example image" />
Notice when we search for “test” a message is returned saying “0 search results for ‘test’”, this means the value that we inputted is being reflected to our web page, which means this site maybe vulnerable to Reflected XSS. Is also important to notice there is a search parameter passing “test” as value in the URL bar. This shows that if this input field is vulnerable to Reflected XSS, it can be exploited by sending crafted URLs leading to user’s accounts being hijacked, credentials stolen, sensitive data exfiltrated, and lastly, access to your client computers can be obtained.</p>
<p>Now we need to test to see if this site is actually vulnerable.</p>
<p>
  <img src="../../3.PNG" alt="Example image" /></p>
<p>
  <img src="../../18.PNG" alt="Example image" /></p>
<p>
  <img src="../../19.PNG" alt="Example image" /></p>
<p>Perfect! We did it.	 Now we can craft URLs with payloads in the search parameter and use some kind of social engineer in order to make someone click it.</p>
<p>As was said, Stored XSS is much more dangerous because the payload is stored in the server. Knowing how XSS works and specifically how Stored XSS works, it’s obvious to think that this type of vulnerability may happen with a common feature, that fulfils all prerequisites, like a comment section. An important thing to mention is that here there is no need for the reflected value to be passed via URL parameter in order to be dangerous.</p>
<h3 id="stored-xss">
  Stored XSS
  <a class="anchor" href="#stored-xss">#</a>
</h3>
<p>Example:</p>
<p>
  <img src="../../20.PNG" alt="Example image" /></p>
<p>The comment added was: <code>&lt;script&gt;alert(“try it 2”)&lt;/script&gt;</code>.
Again, every time someone access this page the script is going to be executed in their browser.</p>
<h2 id="who-to-fix-it">
  <strong>Who to fix it?</strong>
  <a class="anchor" href="#who-to-fix-it">#</a>
</h2>
<ul>
<li>Both reflected and stored XSS can be fixed by performing the appropriate validation and encoding on the server-side. The best way to provide this proper validation and encoding is, as OWASP recommends, using a security-focused encoding library to make sure these rules are properly implemented.</li>
</ul>
<h3 id="reflected-fix">
  Reflected fix:
  <a class="anchor" href="#reflected-fix">#</a>
</h3>
<p>
  <img src="../../12.PNG" alt="Example image" /></p>
<p>My intention in showing this again is to clarify the next steps.</p>
<p>
  <img src="../../21.PNG" alt="Example image" />
This is called <em><strong>Burp suite</strong></em>. <strong>Burp</strong>, as we kindly name it, is a proxy. Ok, but what is a proxy? A proxy is something that seats between you and the server you trying to access. Burp intercepts the traffic between your browser and the server you’re communicating with in order to show exactly how this communication is happening. See that <code>field1=%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E</code> in the URL parameter?
You don’t need to worry, it’s just what we inputted in the credit card number field but it’s URL encoded.</p>
<p>
  <img src="../../8.PNG" alt="Example image" /></p>
<p>The value of that “field1” parameter in the last image is being assigned to a “field1” variable and this variable is used to create a massage that will return to the user. The problem is that this variable is not being sanitized, which causes the XSS.</p>
<p>
  <img src="../../9.PNG" alt="Example image" /></p>
<p>What is happening? We’re simply HTML encoding this string <code>&lt;script&gt;alert(document.domain)&lt;/script&gt;</code> in the variable “field1” to <code>&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;</code>.</p>
<p>
  <img src="../../11.PNG" alt="Example image" /></p>
<p>
  <img src="../../10.PNG" alt="Example image" />
It won’t be executed anymore.</p>
<h3 id="stored-fix">
  Stored fix:
  <a class="anchor" href="#stored-fix">#</a>
</h3>
<pre><code>The exact same fix is used in here.
</code></pre>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#whats-this"><strong>What’s this?</strong></a>
      <ul>
        <li><a href="#reflected-xss">Reflected XSS</a></li>
        <li><a href="#stored-xss">Stored XSS</a></li>
      </ul>
    </li>
    <li><a href="#who-to-fix-it"><strong>Who to fix it?</strong></a>
      <ul>
        <li><a href="#reflected-fix">Reflected fix:</a></li>
        <li><a href="#stored-fix">Stored fix:</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












